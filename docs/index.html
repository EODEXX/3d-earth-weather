<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>3D Earth Weather</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.131/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.131/Build/Cesium/Widgets/widgets.css" rel="stylesheet" />
  <style>
    html, body, #cesiumContainer {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #000;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <script type="module">
    Cesium.Ion.defaultAccessToken = 'your_access_token'; // ‚Üê –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π —Ç–æ–∫–µ–Ω —Å https://cesium.com/ion/

    const viewer = new Cesium.Viewer("cesiumContainer", {
      terrain: Cesium.Terrain.fromWorldTerrain(),
      imageryProvider: new Cesium.OpenStreetMapImageryProvider(),
      animation: true,
      timeline: true,
      baseLayerPicker: false
    });

    viewer.scene.globe.enableLighting = true;
    viewer.scene.skyAtmosphere.show = true;
    viewer.scene.globe.showGroundAtmosphere = true;

    // üåû –°–º–µ–Ω–∞ –¥–Ω—è –∏ –Ω–æ—á–∏
    viewer.clock.multiplier = 3600;
    viewer.clock.shouldAnimate = true;
    viewer.clock.onTick.addEventListener(() => {
      const date = Cesium.JulianDate.toDate(viewer.clock.currentTime);
      const hour = date.getHours() + date.getMinutes() / 60;
      const exposure = viewer.scene.postProcessStages.exposure;

      if (hour >= 9 && hour <= 15) {
        exposure = 2.0;
      } else if (hour > 15 && hour < 19) {
        exposure = Cesium.Math.lerp(2.0, 0.01, (hour - 15) / 4);
      } else if (hour > 6 && hour < 9) {
        exposure = Cesium.Math.lerp(0.01, 2.0, (hour - 6) / 3);
      } else {
        exposure = 0.01;
      }
      viewer.scene.postProcessStages.exposure = exposure;
    });

    // üåç –í—Ä–∞—â–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    let previousTime = Date.now();
    viewer.clock.onTick.addEventListener(() => {
      const currentTime = Date.now();
      const delta = (currentTime - previousTime) / 1000;
      previousTime = currentTime;
      viewer.scene.camera.rotate(Cesium.Cartesian3.UNIT_Z, -0.02 * delta);
    });

    // üìç –ú–µ—Ç–∫–∏ –≥–æ—Ä–æ–¥–æ–≤
    const cities = [
      { name: "–¢–æ–∫–∏–æ", lon: 139.6917, lat: 35.6895 },
      { name: "–ë–µ—Ä–ª–∏–Ω", lon: 13.4050, lat: 52.5200 },
      { name: "–ù—å—é-–ô–æ—Ä–∫", lon: -74.0060, lat: 40.7128 }
    ];

    cities.forEach(city => {
      viewer.entities.add({
        name: city.name,
        position: Cesium.Cartesian3.fromDegrees(city.lon, city.lat),
        point: { pixelSize: 10, color: Cesium.Color.YELLOW },
        label: {
          text: city.name,
          font: "14px sans-serif",
          fillColor: Cesium.Color.WHITE,
          outlineColor: Cesium.Color.BLACK,
          outlineWidth: 2,
          style: Cesium.LabelStyle.FILL_AND_OUTLINE,
          verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
          pixelOffset: new Cesium.Cartesian2(0, -15)
        }
      });
    });

    // üè¢ –ó–¥–∞–Ω–∏–µ –≤ –ë–µ—Ä–ª–∏–Ω–µ (–ª–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å)
    viewer.entities.add({
      name: "–ó–¥–∞–Ω–∏–µ",
      position: Cesium.Cartesian3.fromDegrees(13.4050, 52.52, 0),
      model: {
        uri: "models/building.glb", // ‚Üê —Ä–∞–∑–º–µ—Å—Ç–∏ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ docs/models/
        scale: 2.0,
        minimumPixelSize: 128
      }
    });

    // ‚òÅÔ∏è –û–±–ª–∞–∫–∞ –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã –≤—ã—à–µ
  </script>
</body>
</html>
