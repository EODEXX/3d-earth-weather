<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>3D Earth Weather</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.131/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.131/Build/Cesium/Widgets/widgets.css" rel="stylesheet" />
  <style>
    html, body, #cesiumContainer {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #000;
    }
    #debug {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.7);
      color: #0f0;
      padding: 10px;
      font-family: monospace;
      font-size: 12px;
      z-index: 999;
      max-width: 300px;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <div id="debug">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω—ã...</div>

  <script type="module">
    const debug = document.getElementById("debug");

    Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'; // ‚Üê –≤—Å—Ç–∞–≤—å —Å–≤–æ–π —Ç–æ–∫–µ–Ω

    try {
      const maptiler = new Cesium.UrlTemplateImageryProvider({
        url: 'https://api.maptiler.com/maps/basic/{z}/{x}/{y}.png?key=vOmpgCjC7SdFCJYMvBv8',
        credit: 'MapTiler',
        tilingScheme: new Cesium.WebMercatorTilingScheme()
      });

      const viewer = new Cesium.Viewer("cesiumContainer", {
        imageryProvider: maptiler,
        terrain: Cesium.Terrain.fromWorldTerrain(),
        animation: true,
        timeline: true,
        baseLayerPicker: false
      });

      viewer.scene.globe.enableLighting = true;
      viewer.scene.skyAtmosphere.show = true;
      viewer.scene.globe.showGroundAtmosphere = true;

      // üåç –í—Ä–∞—â–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
      let previousTime = Date.now();
      viewer.clock.shouldAnimate = true;
      viewer.clock.multiplier = 3600;
      viewer.clock.onTick.addEventListener(() => {
        const currentTime = Date.now();
        const delta = (currentTime - previousTime) / 1000;
        previousTime = currentTime;
        viewer.scene.camera.rotate(Cesium.Cartesian3.UNIT_Z, -0.02 * delta);
      });

      // üìç –ú–µ—Ç–∫–∏ –≥–æ—Ä–æ–¥–æ–≤
      const cities = [
        { name: "–¢–æ–∫–∏–æ", lon: 139.6917, lat: 35.6895 },
        { name: "–ë–µ—Ä–ª–∏–Ω", lon: 13.4050, lat: 52.5200 },
        { name: "–ù—å—é-–ô–æ—Ä–∫", lon: -74.0060, lat: 40.7128 },
        { name: "–õ–æ–Ω–¥–æ–Ω", lon: -0.1276, lat: 51.5074 },
        { name: "–°–∏–¥–Ω–µ–π", lon: 151.2093, lat: -33.8688 },
        { name: "–ú–æ—Å–∫–≤–∞", lon: 37.6173, lat: 55.7558 },
        { name: "–ü–∞—Ä–∏–∂", lon: 2.3522, lat: 48.8566 }
      ];

      cities.forEach(city => {
        viewer.entities.add({
          name: city.name,
          position: Cesium.Cartesian3.fromDegrees(city.lon, city.lat),
          point: {
            pixelSize: 10,
            color: Cesium.Color.YELLOW
          },
          label: {
            text: city.name,
            font: "14px sans-serif",
            fillColor: Cesium.Color.WHITE,
            outlineColor: Cesium.Color.BLACK,
            outlineWidth: 2,
            style: Cesium.LabelStyle.FILL_AND_OUTLINE,
            verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
            pixelOffset: new Cesium.Cartesian2(0, -15)
          }
        });
      });

      debug.textContent = "‚úÖ –°—Ü–µ–Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!";
    } catch (error) {
      debug.textContent = "‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:\n" + error.message;
    }
  </script>
</body>
</html>
